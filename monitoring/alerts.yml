groups:
  - name: sre-starter-alerts
    rules:
      - alert: High5xxErrorRate
        expr: |
          (
            sum(rate(http_requests_total{status="5xx", handler="/fail"}[1m]))
            /
            sum(rate(http_requests_total{handler="/fail"}[1m]))
          ) > 0.01
        for: 10s
        labels:
          severity: warning
        annotations:
          summary: "5xx error rate > 1% (1m)"
          description: "5xx error rate is above 1% for 10 seconds."

      - alert: HighP95Latency
        expr: |
          histogram_quantile(
            0.95,
            sum by (le) (rate(http_request_duration_highr_seconds_bucket[5m]))
          ) > 0.2
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "p95 latency > 200ms (5m)"
          description: "p95 latency is above 200ms for 1 minute."
